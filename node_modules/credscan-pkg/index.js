var edge = require('edge-js');
var core = require('@actions/core');

var f = edge.func(require('path').join(__dirname, 'CredScan.cs'));

const credscan = (input) => f(input, function (error, result) {
    if (error) throw error;
    if(input.toString() !== result.toString()){
        core.warning('Credentials were found.');
    }
    var strinput = input.toString();
    var strlen = strinput.length;
    if(strinput[strlen-1] == 0) return input;
    console.log(result);
    return result;
});

const credscan_no_warning = (input) => f(input, function (error, result) {
    if (error) throw error;
    console.log(result);
    return result;
});

module.exports = {credscan, credscan_no_warning};